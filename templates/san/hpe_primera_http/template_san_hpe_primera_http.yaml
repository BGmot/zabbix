zabbix_export:
  version: '6.0'
  date: '2022-04-29T08:17:48Z'
  groups:
    -
      uuid: 7c2cb727f85b492d88cd56e17127c64d
      name: Templates/SAN
  templates:
    -
      uuid: b8750c02b5624c6889979b129735bd56
      template: 'HPE Primera by HTTP'
      name: 'HPE Primera by HTTP'
      description: |
        The template to monitor HPE Primera by HTTP.
        It works without any external scripts and uses the Script items.
        
        Setup:
          1. Create user zabbix on the storage with browse role and enable it for all domains.
          2. The WSAPI server does not start automatically.
             Log in to the CLI as Super, Service, or any role granted the wsapi_set right.
             Start the WSAPI server by command: `startwsapi`.
             To check WSAPI state use command: `showwsapi`.
          3. Link template to the host.
          4. Configure macros {$HPE.PRIMERA.USERNAME} and {$HPE.PRIMERA.PASSWORD}.
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/
        
        Template tooling version used: 0.41
      groups:
        -
          name: Templates/SAN
      items:
        -
          uuid: fff2354ba48b4deb861e47e980e9ed35
          name: 'HPE Primera: Get Common Provisioning Groups'
          type: SCRIPT
          key: hpe.primera.cpgs
          history: 0d
          trends: '0'
          value_type: TEXT
          params: |
            var params = JSON.parse(value);
            var fields = ['username', 'password', 'method', 'base_url'];
            var result = {};
            
            fields.forEach(function (field) {
            	if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '' ) {
            		throw 'Required param is not set: "' + field + '".';
            	}
            });
            
            if (!params.base_url.endsWith('/')) {
            	params.base_url += '/';
            }
            
            var response, request = new HttpRequest();
            request.addHeader('Content-Type: application/json');
            
            credentials = {'user' : params.username, 'password' : params.password};
            
            response = request.post(params.base_url + 'api/v1/credentials', JSON.stringify(credentials));
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Auth request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (response !== null) {
            	try {
            		auth_data = JSON.parse(response);
            	}
            	catch (error) {
            		throw 'Failed to parse auth response received from device API. Check debug log for more information.';
            	}
            }
            
            sessionKey = auth_data['key'];
            
            request = new HttpRequest();
            request.addHeader('X-HP3PAR-WSAPI-SessionKey: ' + sessionKey);
            
            data = request.get(params.base_url + 'api/v1/' + params.method);
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (data !== null) {
            	try {
            		result = JSON.stringify(data);
            	}
            	catch (error) {
            		throw 'Failed to parse response received from device API. Check debug log for more information.';
            	}
            }
            
            request = new HttpRequest();
            response = request.delete(params.base_url + 'api/v1/credentials/' + sessionKey)
            
            if (request.getStatus() !== 200) {
            	throw 'Logout request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            return data;
          description: 'A list of cpgs.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.members
          timeout: '{$HPE.PRIMERA.DATA.TIMEOUT}'
          parameters:
            -
              name: base_url
              value: 'https://{HOST.CONN}'
            -
              name: method
              value: cpgs
            -
              name: password
              value: '{$HPE.PRIMERA.PASSWORD}'
            -
              name: username
              value: '{$HPE.PRIMERA.USERNAME}'
          tags:
            -
              tag: component
              value: raw
        -
          uuid: 2b1fef9aacde40f2bc66cc918adad7ac
          name: 'HPE Primera: Get Physical disks'
          type: SCRIPT
          key: hpe.primera.disks
          delay: 5m
          history: 0d
          trends: '0'
          value_type: TEXT
          params: |
            var params = JSON.parse(value);
            var fields = ['username', 'password', 'method', 'base_url'];
            var result = {};
            
            fields.forEach(function (field) {
            	if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '' ) {
            		throw 'Required param is not set: "' + field + '".';
            	}
            });
            
            if (!params.base_url.endsWith('/')) {
            	params.base_url += '/';
            }
            
            var response, request = new HttpRequest();
            request.addHeader('Content-Type: application/json');
            
            credentials = {'user' : params.username, 'password' : params.password};
            
            response = request.post(params.base_url + 'api/v1/credentials', JSON.stringify(credentials));
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Auth request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (response !== null) {
            	try {
            		auth_data = JSON.parse(response);
            	}
            	catch (error) {
            		throw 'Failed to parse auth response received from device API. Check debug log for more information.';
            	}
            }
            
            sessionKey = auth_data['key'];
            
            request = new HttpRequest();
            request.addHeader('X-HP3PAR-WSAPI-SessionKey: ' + sessionKey);
            
            data = request.get(params.base_url + 'api/v1/' + params.method);
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (data !== null) {
            	try {
            		result = JSON.stringify(data);
            	}
            	catch (error) {
            		throw 'Failed to parse response received from device API. Check debug log for more information.';
            	}
            }
            
            request = new HttpRequest();
            response = request.delete(params.base_url + 'api/v1/credentials/' + sessionKey)
            
            if (request.getStatus() !== 200) {
            	throw 'Logout request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            return data;
          description: 'A list of disks.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.members
          timeout: '{$HPE.PRIMERA.DATA.TIMEOUT}'
          parameters:
            -
              name: base_url
              value: 'https://{HOST.CONN}'
            -
              name: method
              value: disks
            -
              name: password
              value: '{$HPE.PRIMERA.PASSWORD}'
            -
              name: username
              value: '{$HPE.PRIMERA.USERNAME}'
          tags:
            -
              tag: component
              value: raw
        -
          uuid: d5b8a74991d34652973a78d58203d5fd
          name: 'HPE Primera: Disks total'
          type: DEPENDENT
          key: hpe.primera.disks.total
          delay: '0'
          history: 7d
          description: 'Number of physical disks.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.total
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: hpe.primera.disks
          tags:
            -
              tag: component
              value: storage
        -
          uuid: fcd8380a5313449eb6cdbb06b0180a7c
          name: 'HPE Primera: Get Hosts'
          type: SCRIPT
          key: hpe.primera.hosts
          delay: 10m
          history: 0d
          trends: '0'
          value_type: TEXT
          params: |
            var params = JSON.parse(value);
            var fields = ['username', 'password', 'method', 'base_url'];
            var result = {};
            
            fields.forEach(function (field) {
            	if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '' ) {
            		throw 'Required param is not set: "' + field + '".';
            	}
            });
            
            if (!params.base_url.endsWith('/')) {
            	params.base_url += '/';
            }
            
            var response, request = new HttpRequest();
            request.addHeader('Content-Type: application/json');
            
            credentials = {'user' : params.username, 'password' : params.password};
            
            response = request.post(params.base_url + 'api/v1/credentials', JSON.stringify(credentials));
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Auth request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (response !== null) {
            	try {
            		auth_data = JSON.parse(response);
            	}
            	catch (error) {
            		throw 'Failed to parse auth response received from device API. Check debug log for more information.';
            	}
            }
            
            sessionKey = auth_data['key'];
            
            request = new HttpRequest();
            request.addHeader('X-HP3PAR-WSAPI-SessionKey: ' + sessionKey);
            
            data = request.get(params.base_url + 'api/v1/' + params.method);
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (data !== null) {
            	try {
            		result = JSON.stringify(data);
            	}
            	catch (error) {
            		throw 'Failed to parse response received from device API. Check debug log for more information.';
            	}
            }
            
            request = new HttpRequest();
            response = request.delete(params.base_url + 'api/v1/credentials/' + sessionKey)
            
            if (request.getStatus() !== 200) {
            	throw 'Logout request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            return data;
          description: 'A list of hosts.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.members
          timeout: '{$HPE.PRIMERA.DATA.TIMEOUT}'
          parameters:
            -
              name: base_url
              value: 'https://{HOST.CONN}'
            -
              name: method
              value: hosts
            -
              name: password
              value: '{$HPE.PRIMERA.PASSWORD}'
            -
              name: username
              value: '{$HPE.PRIMERA.USERNAME}'
          tags:
            -
              tag: component
              value: raw
        -
          uuid: 2aaa287a0d3849439ea16d7da4d822fe
          name: 'HPE Primera: Get Ports'
          type: SCRIPT
          key: hpe.primera.ports
          history: 0d
          trends: '0'
          value_type: TEXT
          params: |
            var params = JSON.parse(value);
            var fields = ['username', 'password', 'method', 'base_url'];
            var result = {};
            
            fields.forEach(function (field) {
            	if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '' ) {
            		throw 'Required param is not set: "' + field + '".';
            	}
            });
            
            if (!params.base_url.endsWith('/')) {
            	params.base_url += '/';
            }
            
            var response, request = new HttpRequest();
            request.addHeader('Content-Type: application/json');
            
            credentials = {'user' : params.username, 'password' : params.password};
            
            response = request.post(params.base_url + 'api/v1/credentials', JSON.stringify(credentials));
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Auth request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (response !== null) {
            	try {
            		auth_data = JSON.parse(response);
            	}
            	catch (error) {
            		throw 'Failed to parse auth response received from device API. Check debug log for more information.';
            	}
            }
            
            sessionKey = auth_data['key'];
            
            request = new HttpRequest();
            request.addHeader('X-HP3PAR-WSAPI-SessionKey: ' + sessionKey);
            
            data = request.get(params.base_url + 'api/v1/' + params.method);
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (data !== null) {
            	try {
            		result = JSON.stringify(data);
            	}
            	catch (error) {
            		throw 'Failed to parse response received from device API. Check debug log for more information.';
            	}
            }
            
            request = new HttpRequest();
            response = request.delete(params.base_url + 'api/v1/credentials/' + sessionKey)
            
            if (request.getStatus() !== 200) {
            	throw 'Logout request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            return data;
          description: 'A list of ports.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.members
          timeout: '{$HPE.PRIMERA.DATA.TIMEOUT}'
          parameters:
            -
              name: base_url
              value: 'https://{HOST.CONN}'
            -
              name: method
              value: ports
            -
              name: password
              value: '{$HPE.PRIMERA.PASSWORD}'
            -
              name: username
              value: '{$HPE.PRIMERA.USERNAME}'
          tags:
            -
              tag: component
              value: raw
        -
          uuid: efc450d0682c4c5d93df41d05c10eceb
          name: 'HPE Primera: Allocated capacity'
          type: DEPENDENT
          key: hpe.primera.system.allocated.capacity
          delay: '0'
          history: 7d
          units: B
          description: 'Allocated capacity in the system.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.allocatedCapacityMiB
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
            -
              type: MULTIPLIER
              parameters:
                - '1048576'
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: storage
            -
              tag: component
              value: system
        -
          uuid: 65bcf3fb456a45358795d2f9d8249e16
          name: 'HPE Primera: Chunklet size'
          type: DEPENDENT
          key: hpe.primera.system.chunklet.size
          delay: '0'
          history: 7d
          units: B
          description: 'Chunklet size.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.chunkletSizeMiB
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
            -
              type: MULTIPLIER
              parameters:
                - '1048576'
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: storage
            -
              tag: component
              value: system
        -
          uuid: dd6fd61256cc4eeeb94f50d0c86fc51f
          name: 'HPE Primera: Contact'
          type: DEPENDENT
          key: hpe.primera.system.contact
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'Contact of the system.'
          inventory_link: CONTACT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.contact
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: system
        -
          uuid: e3842eec2e45443681670d3c1d194900
          name: 'HPE Primera: Failed capacity'
          type: DEPENDENT
          key: hpe.primera.system.failed.capacity
          delay: '0'
          history: 7d
          units: B
          description: 'Failed capacity in the system.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.failedCapacityMiB
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
            -
              type: MULTIPLIER
              parameters:
                - '1048576'
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: storage
            -
              tag: component
              value: system
        -
          uuid: d23e888299d344238468481689f55e2d
          name: 'HPE Primera: Free capacity'
          type: DEPENDENT
          key: hpe.primera.system.free.capacity
          delay: '0'
          history: 7d
          units: B
          description: 'Free capacity in the system.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.freeCapacityMiB
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
            -
              type: MULTIPLIER
              parameters:
                - '1048576'
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: storage
            -
              tag: component
              value: system
        -
          uuid: c1b34efe07d641698cefffe4beff50fc
          name: 'HPE Primera: Health'
          type: DEPENDENT
          key: hpe.primera.system.health
          delay: '0'
          history: 7d
          description: 'System availability.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.id
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: health
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 570d440e7ec9445585003208eca06e63
              expression: 'last(/HPE Primera by HTTP/hpe.primera.system.health)=0'
              name: 'HPE Primera: The host is not available by API'
              priority: HIGH
              description: 'ID from system information is 0 or can not retrieve system information.'
              tags:
                -
                  tag: scope
                  value: availability
        -
          uuid: 0e0e4c5c08dd420ab26862bfa140d729
          name: 'HPE Primera: Get System Information'
          type: SCRIPT
          key: hpe.primera.system.info
          history: 0d
          trends: '0'
          value_type: TEXT
          params: |
            var params = JSON.parse(value);
            var fields = ['username', 'password', 'method', 'base_url'];
            var result = {};
            
            fields.forEach(function (field) {
            	if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '' ) {
            		throw 'Required param is not set: "' + field + '".';
            	}
            });
            
            if (!params.base_url.endsWith('/')) {
            	params.base_url += '/';
            }
            
            var response, request = new HttpRequest();
            request.addHeader('Content-Type: application/json');
            
            credentials = {'user' : params.username, 'password' : params.password};
            
            response = request.post(params.base_url + 'api/v1/credentials', JSON.stringify(credentials));
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Auth request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (response !== null) {
            	try {
            		auth_data = JSON.parse(response);
            	}
            	catch (error) {
            		throw 'Failed to parse auth response received from device API. Check debug log for more information.';
            	}
            }
            
            sessionKey = auth_data['key'];
            
            request = new HttpRequest();
            request.addHeader('X-HP3PAR-WSAPI-SessionKey: ' + sessionKey);
            
            data = request.get(params.base_url + 'api/v1/' + params.method);
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (data !== null) {
            	try {
            		result = JSON.stringify(data);
            	}
            	catch (error) {
            		throw 'Failed to parse response received from device API. Check debug log for more information.';
            	}
            }
            
            request = new HttpRequest();
            response = request.delete(params.base_url + 'api/v1/credentials/' + sessionKey)
            
            if (request.getStatus() !== 200) {
            	throw 'Logout request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            return data;
          description: 'General System information.'
          preprocessing:
            -
              type: CHECK_NOT_SUPPORTED
              parameters:
                - ''
              error_handler: CUSTOM_VALUE
              error_handler_params: '{}'
          timeout: '{$HPE.PRIMERA.DATA.TIMEOUT}'
          parameters:
            -
              name: base_url
              value: 'https://{HOST.CONN}'
            -
              name: method
              value: system
            -
              name: password
              value: '{$HPE.PRIMERA.PASSWORD}'
            -
              name: username
              value: '{$HPE.PRIMERA.USERNAME}'
          tags:
            -
              tag: component
              value: raw
        -
          uuid: dd61f3a680284893801c96bdbd445645
          name: 'HPE Primera: Location'
          type: DEPENDENT
          key: hpe.primera.system.location
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'Location of the system.'
          inventory_link: LOCATION
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.location
              error_handler: DISCARD_VALUE
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: system
        -
          uuid: 5f28ec66be1f43208139476af3653997
          name: 'HPE Primera: Model'
          type: DEPENDENT
          key: hpe.primera.system.model
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'System model.'
          inventory_link: MODEL
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.model
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: system
        -
          uuid: 45281453bf204365a8a8ac2ba7255e54
          name: 'HPE Primera: Name'
          type: DEPENDENT
          key: hpe.primera.system.name
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'System name.'
          inventory_link: NAME
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.name
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: system
        -
          uuid: acf6d37022884dc99a3b55c95f6b19c8
          name: 'HPE Primera: Online nodes count'
          type: DEPENDENT
          key: hpe.primera.system.online.nodes
          delay: '0'
          history: 7d
          description: 'Number of online nodes in the system.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.onlineNodes
            -
              type: JAVASCRIPT
              parameters:
                - 'return value.length'
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: system
        -
          uuid: d194672ea7f64dd58296d7fb2537f35b
          name: 'HPE Primera: Serial Number'
          type: DEPENDENT
          key: hpe.primera.system.serial.number
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'System serial number.'
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.serialNumber
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: system
        -
          uuid: e0f0ff7657784c8eab1a71a68ceefc19
          name: 'HPE Primera: Software version number'
          type: DEPENDENT
          key: hpe.primera.system.sw.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          description: 'Storage system software version number.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.systemVersion
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: system
        -
          uuid: 1e6fc0d68d18474e84b4fe2e4d3374d1
          name: 'HPE Primera: Total capacity'
          type: DEPENDENT
          key: hpe.primera.system.total.capacity
          delay: '0'
          history: 7d
          units: B
          description: 'Total capacity in the system.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.totalCapacityMiB
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
            -
              type: MULTIPLIER
              parameters:
                - '1048576'
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: storage
            -
              tag: component
              value: system
        -
          uuid: 65b22e04d7334aaf970a8961a46c22c9
          name: 'HPE Primera: Total nodes'
          type: DEPENDENT
          key: hpe.primera.system.total.nodes
          delay: '0'
          history: 7d
          description: 'Total number of nodes in the system.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.totalNodes
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: hpe.primera.system.info
          tags:
            -
              tag: component
              value: system
        -
          uuid: 05fd350143374c73a5502011dd05b119
          name: 'HPE Primera: Get Tasks'
          type: SCRIPT
          key: hpe.primera.tasks
          history: 0d
          trends: '0'
          value_type: TEXT
          params: |
            var params = JSON.parse(value);
            var fields = ['username', 'password', 'method', 'base_url'];
            var result = {};
            
            fields.forEach(function (field) {
            	if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '' ) {
            		throw 'Required param is not set: "' + field + '".';
            	}
            });
            
            if (!params.base_url.endsWith('/')) {
            	params.base_url += '/';
            }
            
            var response, request = new HttpRequest();
            request.addHeader('Content-Type: application/json');
            
            credentials = {'user' : params.username, 'password' : params.password};
            
            response = request.post(params.base_url + 'api/v1/credentials', JSON.stringify(credentials));
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Auth request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (response !== null) {
            	try {
            		auth_data = JSON.parse(response);
            	}
            	catch (error) {
            		throw 'Failed to parse auth response received from device API. Check debug log for more information.';
            	}
            }
            
            sessionKey = auth_data['key'];
            
            request = new HttpRequest();
            request.addHeader('X-HP3PAR-WSAPI-SessionKey: ' + sessionKey);
            
            data = request.get(params.base_url + 'api/v1/' + params.method);
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (data !== null) {
            	try {
            		result = JSON.stringify(data);
            	}
            	catch (error) {
            		throw 'Failed to parse response received from device API. Check debug log for more information.';
            	}
            }
            
            request = new HttpRequest();
            response = request.delete(params.base_url + 'api/v1/credentials/' + sessionKey)
            
            if (request.getStatus() !== 200) {
            	throw 'Logout request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            return data;
          description: 'A list of latest executed, in progress or failed tasks.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.members
            -
              type: JAVASCRIPT
              parameters:
                - |
                  result = [];
                  tasks = JSON.parse(value);
                  
                  tmp_tasks = {};
                  
                  tasks.forEach(function (task) {
                    task_name = task.name;
                    tmp_tasks[task_name] = task;
                  });
                  
                  for (var task in tmp_tasks) {
                    result.push(tmp_tasks[task])
                  };
                  
                  return JSON.stringify(result);
          timeout: '{$HPE.PRIMERA.DATA.TIMEOUT}'
          parameters:
            -
              name: base_url
              value: 'https://{HOST.CONN}'
            -
              name: method
              value: tasks
            -
              name: password
              value: '{$HPE.PRIMERA.PASSWORD}'
            -
              name: username
              value: '{$HPE.PRIMERA.USERNAME}'
          tags:
            -
              tag: component
              value: raw
        -
          uuid: d1744dbb6e21418cb314e77041890f67
          name: 'HPE Primera: Get Volumes'
          type: SCRIPT
          key: hpe.primera.volumes
          delay: 5m
          history: 0d
          trends: '0'
          value_type: TEXT
          params: |
            var params = JSON.parse(value);
            var fields = ['username', 'password', 'method', 'base_url'];
            var result = {};
            
            fields.forEach(function (field) {
            	if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '' ) {
            		throw 'Required param is not set: "' + field + '".';
            	}
            });
            
            if (!params.base_url.endsWith('/')) {
            	params.base_url += '/';
            }
            
            var response, request = new HttpRequest();
            request.addHeader('Content-Type: application/json');
            
            credentials = {'user' : params.username, 'password' : params.password};
            
            response = request.post(params.base_url + 'api/v1/credentials', JSON.stringify(credentials));
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Auth request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (response !== null) {
            	try {
            		auth_data = JSON.parse(response);
            	}
            	catch (error) {
            		throw 'Failed to parse auth response received from device API. Check debug log for more information.';
            	}
            }
            
            sessionKey = auth_data['key'];
            
            request = new HttpRequest();
            request.addHeader('X-HP3PAR-WSAPI-SessionKey: ' + sessionKey);
            
            data = request.get(params.base_url + 'api/v1/' + params.method);
            
            if (request.getStatus() < 200 || request.getStatus() >= 300) {
            	throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            if (data !== null) {
            	try {
            		result = JSON.stringify(data);
            	}
            	catch (error) {
            		throw 'Failed to parse response received from device API. Check debug log for more information.';
            	}
            }
            
            request = new HttpRequest();
            response = request.delete(params.base_url + 'api/v1/credentials/' + sessionKey)
            
            if (request.getStatus() !== 200) {
            	throw 'Logout request failed with status code ' + request.getStatus() + ': ' + response;
            }
            
            return data;
          description: 'A list of storage volumes.'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.members
          timeout: '{$HPE.PRIMERA.DATA.TIMEOUT}'
          parameters:
            -
              name: base_url
              value: 'https://{HOST.CONN}'
            -
              name: method
              value: volumes
            -
              name: password
              value: '{$HPE.PRIMERA.PASSWORD}'
            -
              name: username
              value: '{$HPE.PRIMERA.USERNAME}'
          tags:
            -
              tag: component
              value: raw
      discovery_rules:
        -
          uuid: b9132b095eb349c99e868ea40364596d
          name: 'Common Provisioning Groups Discovery'
          type: DEPENDENT
          key: hpe.primera.cpg.discovery
          delay: '0'
          description: 'List of CPGs resources.'
          item_prototypes:
            -
              uuid: ae3e249556334ab49ed126f854e65386
              name: 'CPG [{#NAME}]: Additional State'
              type: DEPENDENT
              key: 'hpe.primera.cpg.additional.states["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                Detailed state of the CPG:
                
                LDS_NOT_STARTED (1) - LDs not started.
                NOT_STARTED (2) - VV not started.
                NEEDS_CHECK (3) - Check for consistency.
                NEEDS_MAINT_CHECK (4) - Maintenance check is required.
                INTERNAL_CONSISTENCY_ERROR (5) - Internal consistency error.
                SNAPDATA_INVALID (6) - Invalid snapshot data.
                PRESERVED (7) - Unavailable LD sets due to missing chunklets. Preserved remaining VV data.
                STALE (8) - Parts of the VV contain old data because of a copy-on-write operation.
                COPY_FAILED (9) - A promote or copy operation to this volume failed.
                DEGRADED_AVAIL (10) - Degraded due to availability.
                DEGRADED_PERF (11) - Degraded due to performance.
                PROMOTING (12) - Volume is the current target of a promote operation.
                COPY_TARGET (13) - Volume is the current target of a physical copy operation.
                RESYNC_TARGET (14) - Volume is the current target of a resynchronized copy operation.
                TUNING (15) - Volume tuning is in progress.
                CLOSING (16) - Volume is closing.
                REMOVING (17) - Removing the volume.
                REMOVING_RETRY (18) - Retrying a volume removal operation.
                CREATING (19) - Creating a volume.
                COPY_SOURCE (20) - Copy source.
                IMPORTING (21) - Importing a volume.
                CONVERTING (22) - Converting a volume.
                INVALID (23) - Invalid.
                EXCLUSIVE (24) - Local storage system has exclusive access to the volume.
                CONSISTENT (25) - Volume is being imported consistently along with other volumes in the VV set.
                STANDBY (26) - Volume in Standby mode.
                SD_META_INCONSISTENT (27) - SD Meta Inconsistent.
                SD_NEEDS_FIX (28) - SD needs fix.
                SD_META_FIXING (29) - SD meta fix.
                UNKNOWN (999) - Unknown state.
                NOT_SUPPORTED_BY_WSAPI (1000) - State not supported by WSAPI.
              valuemap:
                name: 'Primera: Volume detailed state enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].additionalStates.first()'
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return JSON.stringify(JSON.parse(value));'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: a7e2188d600a4715a58deba46f3b46ac
              name: 'CPG [{#NAME}]: Degraded State'
              type: DEPENDENT
              key: 'hpe.primera.cpg.degraded.states["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                Detailed state of the CPG:
                
                LDS_NOT_STARTED (1) - LDs not started.
                NOT_STARTED (2) - VV not started.
                NEEDS_CHECK (3) - Check for consistency.
                NEEDS_MAINT_CHECK (4) - Maintenance check is required.
                INTERNAL_CONSISTENCY_ERROR (5) - Internal consistency error.
                SNAPDATA_INVALID (6) - Invalid snapshot data.
                PRESERVED (7) - Unavailable LD sets due to missing chunklets. Preserved remaining VV data.
                STALE (8) - Parts of the VV contain old data because of a copy-on-write operation.
                COPY_FAILED (9) - A promote or copy operation to this volume failed.
                DEGRADED_AVAIL (10) - Degraded due to availability.
                DEGRADED_PERF (11) - Degraded due to performance.
                PROMOTING (12) - Volume is the current target of a promote operation.
                COPY_TARGET (13) - Volume is the current target of a physical copy operation.
                RESYNC_TARGET (14) - Volume is the current target of a resynchronized copy operation.
                TUNING (15) - Volume tuning is in progress.
                CLOSING (16) - Volume is closing.
                REMOVING (17) - Removing the volume.
                REMOVING_RETRY (18) - Retrying a volume removal operation.
                CREATING (19) - Creating a volume.
                COPY_SOURCE (20) - Copy source.
                IMPORTING (21) - Importing a volume.
                CONVERTING (22) - Converting a volume.
                INVALID (23) - Invalid.
                EXCLUSIVE (24) - Local storage system has exclusive access to the volume.
                CONSISTENT (25) - Volume is being imported consistently along with other volumes in the VV set.
                STANDBY (26) - Volume in Standby mode.
                SD_META_INCONSISTENT (27) - SD Meta Inconsistent.
                SD_NEEDS_FIX (28) - SD needs fix.
                SD_META_FIXING (29) - SD meta fix.
                UNKNOWN (999) - Unknown state.
                NOT_SUPPORTED_BY_WSAPI (1000) - State not supported by WSAPI.
              valuemap:
                name: 'Primera: Volume detailed state enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].degradedStates.first()'
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return JSON.stringify(JSON.parse(value));'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 837b48053400487885bf051a78f2200a
              name: 'CPG [{#NAME}]: Failed State'
              type: DEPENDENT
              key: 'hpe.primera.cpg.failed.states["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                Detailed state of the CPG:
                
                LDS_NOT_STARTED (1) - LDs not started.
                NOT_STARTED (2) - VV not started.
                NEEDS_CHECK (3) - Check for consistency.
                NEEDS_MAINT_CHECK (4) - Maintenance check is required.
                INTERNAL_CONSISTENCY_ERROR (5) - Internal consistency error.
                SNAPDATA_INVALID (6) - Invalid snapshot data.
                PRESERVED (7) - Unavailable LD sets due to missing chunklets. Preserved remaining VV data.
                STALE (8) - Parts of the VV contain old data because of a copy-on-write operation.
                COPY_FAILED (9) - A promote or copy operation to this volume failed.
                DEGRADED_AVAIL (10) - Degraded due to availability.
                DEGRADED_PERF (11) - Degraded due to performance.
                PROMOTING (12) - Volume is the current target of a promote operation.
                COPY_TARGET (13) - Volume is the current target of a physical copy operation.
                RESYNC_TARGET (14) - Volume is the current target of a resynchronized copy operation.
                TUNING (15) - Volume tuning is in progress.
                CLOSING (16) - Volume is closing.
                REMOVING (17) - Removing the volume.
                REMOVING_RETRY (18) - Retrying a volume removal operation.
                CREATING (19) - Creating a volume.
                COPY_SOURCE (20) - Copy source.
                IMPORTING (21) - Importing a volume.
                CONVERTING (22) - Converting a volume.
                INVALID (23) - Invalid.
                EXCLUSIVE (24) - Local storage system has exclusive access to the volume.
                CONSISTENT (25) - Volume is being imported consistently along with other volumes in the VV set.
                STANDBY (26) - Volume in Standby mode.
                SD_META_INCONSISTENT (27) - SD Meta Inconsistent.
                SD_NEEDS_FIX (28) - SD needs fix.
                SD_META_FIXING (29) - SD meta fix.
                UNKNOWN (999) - Unknown state.
                NOT_SUPPORTED_BY_WSAPI (1000) - State not supported by WSAPI.
              valuemap:
                name: 'Primera: Volume detailed state enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].failedStates.first()'
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return JSON.stringify(JSON.parse(value));'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 6d070a747a01498b94c56da721a63192
              name: 'CPG [{#NAME}]: Number of FPVVs'
              type: DEPENDENT
              key: 'hpe.primera.cpg.fpvvs.number["{#NAME}"]'
              delay: '0'
              history: 7d
              description: 'Number of FPVVs (Fully Provisioned Virtual Volumes) allocated in the CPG.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].numFPVVs.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: a6cd977f27a8463cb385715327e34955
              name: 'CPG [{#NAME}]: Free CPG space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.free.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Free CPG space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].freeSpaceMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: a7fccd5afcf5469ca11a9436240eab5c
              name: 'CPG [{#NAME}]: Raw free space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.raw.free.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Raw free space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].rawFreeSpaceMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 8f26a54327f54e968f422081e6045217
              name: 'CPG [{#NAME}]: Raw shared space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.raw.shared.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Raw shared space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].rawSharedSpaceMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: e3ac07e2707a44fd8c166f4618fd79a1
              name: 'CPG [{#NAME}]: Raw total space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.raw.total.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Raw total space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].rawTotalSpaceMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 6dfd722ad85b481a9c2b04a4a5eb91fe
              name: 'CPG [{#NAME}]: Total (raw) logical disk space in Snapshot administration'
              type: DEPENDENT
              key: 'hpe.primera.cpg.sa.usage.raw.total["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot administration usage. Total physical (raw) logical disk space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].SAUsage.rawTotalMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 8b2dc75fdcfa48908ece97768641f055
              name: 'CPG [{#NAME}]: Used (raw) logical disk space in Snapshot administration'
              type: DEPENDENT
              key: 'hpe.primera.cpg.sa.usage.raw.used["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot administration usage. Amount of physical (raw) logical disk used.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].SAUsage.rawUsedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: d55f0eab811641fdbb9a8bc8c54815ee
              name: 'CPG [{#NAME}]: Total logical disk space in Snapshot administration'
              type: DEPENDENT
              key: 'hpe.primera.cpg.sa.usage.total["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot administration usage. Total logical disk space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].SAUsage.totalMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: cf467bc7d9ac45259f284eeab6ae7f6a
              name: 'CPG [{#NAME}]: Used logical disk space in Snapshot administration'
              type: DEPENDENT
              key: 'hpe.primera.cpg.sa.usage.used["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot administration usage. Amount of logical disk used.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].SAUsage.usedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 61dd9aa18c714863b606d18b2fff6c57
              name: 'CPG [{#NAME}]: Total (raw) logical disk space in Snapshot data'
              type: DEPENDENT
              key: 'hpe.primera.cpg.sd.usage.raw.total["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot data space usage. Total physical (raw) logical disk space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].SDUsage.rawTotalMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: f95ee3c4c0c64d46a47dd68b346f2fa5
              name: 'CPG [{#NAME}]: Used (raw) logical disk space in Snapshot data'
              type: DEPENDENT
              key: 'hpe.primera.cpg.sd.usage.raw.used["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot data space usage. Amount of physical (raw) logical disk used.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].SDUsage.rawUsedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 797f3335d8704d4bb8b53e34b3e6589e
              name: 'CPG [{#NAME}]: Total logical disk space in Snapshot data'
              type: DEPENDENT
              key: 'hpe.primera.cpg.sd.usage.total["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot data space usage. Total logical disk space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].SDUsage.totalMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 51e40f6a1eb249d58bd79948d403d4f7
              name: 'CPG [{#NAME}]: Used logical disk space in Snapshot data'
              type: DEPENDENT
              key: 'hpe.primera.cpg.sd.usage.used["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot data space usage. Amount of logical disk used.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].SDUsage.usedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 17cf1cddafd444f8a5616a472c1a019b
              name: 'CPG [{#NAME}]: Shared CPG space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.shared.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Shared CPG space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].sharedSpaceMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 3fe9b7c875c248e3b09c98162e30ebf8
              name: 'CPG [{#NAME}]: State'
              type: DEPENDENT
              key: 'hpe.primera.cpg.state["{#NAME}"]'
              delay: '0'
              history: 7d
              description: |
                Overall state of the CPG:
                
                NORMAL (1) - Normal operation;
                DEGRADED (2) - Degraded state;
                FAILED (3) - Abnormal operation;
                UNKNOWN (99) - Unknown state.
              valuemap:
                name: 'Primera: State enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].state.first()'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
              trigger_prototypes:
                -
                  uuid: 32a29b7a4bf340ef8ab07a8db3bef309
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.cpg.state["{#NAME}"])=2'
                  name: 'CPG [{#NAME}]: Degraded'
                  priority: AVERAGE
                  description: 'CPG [{#NAME}] in degraded state.'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: capacity
                -
                  uuid: 85c26e64c8074e8b9ab52f20394afeee
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.cpg.state["{#NAME}"])=3'
                  name: 'CPG [{#NAME}]: Failed'
                  priority: HIGH
                  description: 'CPG [{#NAME}] in failed state.'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: capacity
            -
              uuid: 18544a7742af4678bd8c37ad84a8d137
              name: 'CPG [{#NAME}]: Number of TDVVs'
              type: DEPENDENT
              key: 'hpe.primera.cpg.tdvvs.number["{#NAME}"]'
              delay: '0'
              history: 7d
              description: 'Number of TDVVs (Thinly Deduplicated Virtual Volume) created in the CPG.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].numTDVVs.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 3950d779a0394615b8ec311525ed4168
              name: 'CPG [{#NAME}]: Total CPG space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.total.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Total CPG space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].totalSpaceMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: f93dc70fa63a47da9253a447a67df685
              name: 'CPG [{#NAME}]: Number of TPVVs'
              type: DEPENDENT
              key: 'hpe.primera.cpg.tpvvs.number["{#NAME}"]'
              delay: '0'
              history: 7d
              description: 'Number of TPVVs (Thinly Provisioned Virtual Volumes) allocated in the CPG.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].numTPVVs.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: b7a8880bdafe4f0da4dd8cee6d4fdfa4
              name: 'CPG [{#NAME}]: Total (raw) logical disk space in User space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.usr.usage.raw.total["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'User data space usage. Total physical (raw) logical disk space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].UsrUsage.rawTotalMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 1feabd57f12a48b98dab098435179725
              name: 'CPG [{#NAME}]: Used (raw) logical disk space in User space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.usr.usage.raw.used["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'User data space usage. Amount of physical (raw) logical disk used.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].UsrUsage.rawUsedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: 6f85014bc639420aa409d97d42cb75b2
              name: 'CPG [{#NAME}]: Total logical disk space in User space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.usr.usage.total["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'User data space usage. Total logical disk space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].UsrUsage.totalMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
            -
              uuid: c21f77a45ab443099bf957fbb39478f3
              name: 'CPG [{#NAME}]: Used logical disk space in User space'
              type: DEPENDENT
              key: 'hpe.primera.cpg.usr.usage.used["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'User data space usage. Amount of logical disk used.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].UsrUsage.usedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.cpgs
              tags:
                -
                  tag: component
                  value: cpg
                -
                  tag: component
                  value: storage
                -
                  tag: cpg
                  value: '{#NAME}'
          graph_prototypes:
            -
              uuid: 0ffb02e0b9144e0583489ca1d1c8d2dd
              name: 'CPG [{#NAME}]: Snapshot administration usage'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.sa.usage.total["{#NAME}"]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.sa.usage.used["{#NAME}"]'
                -
                  sortorder: '2'
                  color: F63100
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.sa.usage.raw.total["{#NAME}"]'
                -
                  sortorder: '3'
                  color: A54F10
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.sa.usage.raw.used["{#NAME}"]'
            -
              uuid: d64484828dda48cbbf7dc0f8a9c2f34d
              name: 'CPG [{#NAME}]: Snapshot data usage'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.sd.usage.total["{#NAME}"]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.sd.usage.used["{#NAME}"]'
                -
                  sortorder: '2'
                  color: F63100
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.sd.usage.raw.total["{#NAME}"]'
                -
                  sortorder: '3'
                  color: A54F10
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.sd.usage.raw.used["{#NAME}"]'
            -
              uuid: dd590898a3644130b897f57e8837cb3a
              name: 'CPG [{#NAME}]: User space'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.usr.usage.total["{#NAME}"]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.usr.usage.used["{#NAME}"]'
                -
                  sortorder: '2'
                  color: F63100
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.usr.usage.raw.total["{#NAME}"]'
                -
                  sortorder: '3'
                  color: A54F10
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.cpg.usr.usage.raw.used["{#NAME}"]'
          master_item:
            key: hpe.primera.cpgs
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#NAME}'
              path: $.name
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        -
          uuid: a83ed573e6ab40e8b7306178ddd2658b
          name: 'Disks Discovery'
          type: DEPENDENT
          key: hpe.primera.disks.discovery
          delay: '0'
          description: 'List of physical disk resources.'
          item_prototypes:
            -
              uuid: 40e074af5d7f44bb8691290971fc7c5c
              name: 'Disk [{#POSITION}]: Free size'
              type: DEPENDENT
              key: 'hpe.primera.disk.free.size["{#POSITION}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Physical disk free size.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].freeSizeMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: 9bb7a86118614d339b4dee3238b261ff
              name: 'Disk [{#POSITION}]: Firmware version'
              type: DEPENDENT
              key: 'hpe.primera.disk.fw.version["{#POSITION}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Physical disk firmware version.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].fwVersion.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: 288f7eef0a7c43afa7a3623471c92097
              name: 'Disk [{#POSITION}]: Path A0 Degraded'
              type: DEPENDENT
              key: 'hpe.primera.disk.loop.a0.degraded["{#POSITION}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Indicates if this is a degraded path for the disk.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].loopA0.degraded.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: 1e89322b49fb46bdacd22a562995f2fc
              name: 'Disk [{#POSITION}]: Path A1 Degraded'
              type: DEPENDENT
              key: 'hpe.primera.disk.loop.a1.degraded["{#POSITION}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Indicates if this is a degraded path for the disk.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].loopA1.degraded.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: 2b56e5a6ffbd4e6189fff707d508f955
              name: 'Disk [{#POSITION}]: Path B0 Degraded'
              type: DEPENDENT
              key: 'hpe.primera.disk.loop.b0.degraded["{#POSITION}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Indicates if this is a degraded path for the disk.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].loopB0.degraded.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: cfb88804564d4e0c914760daec53276f
              name: 'Disk [{#POSITION}]: Path B1 Degraded'
              type: DEPENDENT
              key: 'hpe.primera.disk.loop.b1.degraded["{#POSITION}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Indicates if this is a degraded path for the disk.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].loopB1.degraded.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: 1387d1129e4a418e91fb0e99179116f5
              name: 'Disk [{#POSITION}]: Manufacturer'
              type: DEPENDENT
              key: 'hpe.primera.disk.manufacturer["{#POSITION}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Physical disk manufacturer.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].manufacturer.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: 1892d6230e244e1089a5eca8654ba2fa
              name: 'Disk [{#POSITION}]: Model'
              type: DEPENDENT
              key: 'hpe.primera.disk.model["{#POSITION}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Manufacturer''s device ID for disk.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].model.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: 495ceedbdf1644fdb56cf56123c1ec01
              name: 'Disk [{#POSITION}]: RPM'
              type: DEPENDENT
              key: 'hpe.primera.disk.rpm["{#POSITION}"]'
              delay: '0'
              history: 7d
              units: '!rpm'
              description: 'RPM of the physical disk.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].RPM.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: 07fa233e273d4d6e9813705d0afc82f5
              name: 'Disk [{#POSITION}]: Serial Number'
              type: DEPENDENT
              key: 'hpe.primera.disk.serial.number["{#POSITION}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Disk drive serial number.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].serialNumber.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
            -
              uuid: acb23a0dc2674f57bada95dd12972662
              name: 'Disk [{#POSITION}]: State'
              type: DEPENDENT
              key: 'hpe.primera.disk.state["{#POSITION}"]'
              delay: '0'
              history: 7d
              description: |
                State of the physical disk:
                
                Normal (1) - Physical disk is in Normal state;
                Degraded (2) - Physical disk is not operating normally;
                New (3) - Physical disk is new, needs to be admitted;
                Failed (4) - Physical disk has failed;
                Unknown (99) - Physical disk state is unknown.
              valuemap:
                name: 'Primera: diskState enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].state.first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '99'
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
              trigger_prototypes:
                -
                  uuid: d8991103e26b4ffea5fb64dc3519eb63
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.disk.state["{#POSITION}"])=2'
                  name: 'Disk [{#POSITION}]: Degraded'
                  priority: AVERAGE
                  description: 'Disk [{#POSITION}] in degraded state.'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: capacity
                -
                  uuid: bc8c8281c3ac4742ba8f570a56753dd3
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.disk.state["{#POSITION}"])=3'
                  name: 'Disk [{#POSITION}]: Failed'
                  priority: HIGH
                  description: 'Disk [{#POSITION}] in failed state.'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: capacity
                -
                  uuid: d4bda084df0b4a489fac08d1acae4e17
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.disk.state["{#POSITION}"])=99'
                  name: 'Disk [{#POSITION}]: Unknown issue'
                  priority: INFO
                  description: 'Disk [{#POSITION}] in unknown state.'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: capacity
            -
              uuid: 83395e3165c949e8997e93bfce0ac1d0
              name: 'Disk [{#POSITION}]: Total size'
              type: DEPENDENT
              key: 'hpe.primera.disk.total.size["{#POSITION}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Physical disk total size.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.position == "{#POSITION}")].totalSizeMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.disks
              tags:
                -
                  tag: component
                  value: disk
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#POSITION}'
          master_item:
            key: hpe.primera.disks
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#POSITION}'
              path: $.position
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        -
          uuid: 77ae172949044c148ac8f56f05d3af33
          name: 'Hosts Discovery'
          type: DEPENDENT
          key: hpe.primera.hosts.discovery
          delay: '0'
          filter:
            conditions:
              -
                macro: '{#NAME}'
                operator: EXISTS
                formulaid: A
          description: 'List of host resources.'
          item_prototypes:
            -
              uuid: 142a03a36dbf477ebbcb99994efe4246
              name: 'Host [{#NAME}]: Comment'
              type: DEPENDENT
              key: 'hpe.primera.host.comment["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'Additional information for the host.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].descriptors.comment.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.hosts
              tags:
                -
                  tag: component
                  value: host
                -
                  tag: host
                  value: '{#NAME}'
            -
              uuid: 44a06761b5174c67ace5487b7ec9f0e5
              name: 'Host [{#NAME}]: Contact'
              type: DEPENDENT
              key: 'hpe.primera.host.contact["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'The host''s owner and contact.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].descriptors.contact.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.hosts
              tags:
                -
                  tag: component
                  value: host
                -
                  tag: host
                  value: '{#NAME}'
            -
              uuid: b3bd017e96d843248bbb9cb2240e861b
              name: 'Host [{#NAME}]: IP Address'
              type: DEPENDENT
              key: 'hpe.primera.host.ipaddress["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'The host''s IP address.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].descriptors.IPAddr.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.hosts
              tags:
                -
                  tag: component
                  value: host
                -
                  tag: host
                  value: '{#NAME}'
            -
              uuid: 367466a0f7084e579f3c11d820dc7f04
              name: 'Host [{#NAME}]: Location'
              type: DEPENDENT
              key: 'hpe.primera.host.location["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'The host''s location.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].descriptors.location.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.hosts
              tags:
                -
                  tag: component
                  value: host
                -
                  tag: host
                  value: '{#NAME}'
            -
              uuid: 997e52f8f50e47738a1aefbcedaa5a82
              name: 'Host [{#NAME}]: Model'
              type: DEPENDENT
              key: 'hpe.primera.host.model["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'The host''s model.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].descriptors.model.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.hosts
              tags:
                -
                  tag: component
                  value: host
                -
                  tag: host
                  value: '{#NAME}'
            -
              uuid: 4db5068c8aea4940adb5f8863d50ef47
              name: 'Host [{#NAME}]: OS'
              type: DEPENDENT
              key: 'hpe.primera.host.os["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: 'The operating system running on the host.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].descriptors.os.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: hpe.primera.hosts
              tags:
                -
                  tag: component
                  value: host
                -
                  tag: host
                  value: '{#NAME}'
          master_item:
            key: hpe.primera.hosts
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#NAME}'
              path: $.name
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        -
          uuid: 3c9222777f2649749df76cbf61601557
          name: 'Ports Discovery'
          type: DEPENDENT
          key: hpe.primera.ports.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#TYPE}'
                value: '3'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          description: 'List of port resources.'
          item_prototypes:
            -
              uuid: 9241e0b26de74ea49f28e1c09e15a2cd
              name: 'Port [{#NODE}:{#SLOT}:{#CARD_PORT}]: Failover State'
              type: DEPENDENT
              key: 'hpe.primera.port.failover.state["{#NODE}:{#SLOT}:{#CARD_PORT}"]'
              delay: '0'
              history: 7d
              description: |
                The state of the failover operation, shown for the two ports indicated in the N:S:P and Partner columns. The value can be one of the following:
                
                none (1) - No failover in operation;
                failover_pending (2) - In the process of failing over to partner;
                failed_over (3) - Failed over to partner;
                active (4) - The partner port is failed over to this port;
                active_down (5) - The partner port is failed over to this port, but this port is down;
                active_failed (6) - The partner port is failed over to this port, but this port is down;
                failback_pending (7) - In the process of failing back from partner.
              valuemap:
                name: 'Primera: portFailOverState enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.portPos.node == "{#NODE}" && @.portPos.slot == "{#SLOT}" && @.portPos.cardPort == "{#CARD_PORT}")].failoverState.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: hpe.primera.ports
              tags:
                -
                  tag: component
                  value: port
                -
                  tag: label
                  value: '{#LABEL}'
                -
                  tag: port
                  value: '{#NODE}:{#SLOT}:{#CARD_PORT}'
              trigger_prototypes:
                -
                  uuid: 65f3f3b098984842b5246bfb5842bc78
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.port.failover.state["{#NODE}:{#SLOT}:{#CARD_PORT}"])<>1 and last(/HPE Primera by HTTP/hpe.primera.port.failover.state["{#NODE}:{#SLOT}:{#CARD_PORT}"])<>4'
                  name: 'Port [{#NODE}:{#SLOT}:{#CARD_PORT}]: Failover state is {ITEM.VALUE1}'
                  priority: AVERAGE
                  description: 'Port [{#NODE}:{#SLOT}:{#CARD_PORT}] has failover error.'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: capacity
            -
              uuid: 8abba6d6f6e749b0be277056421a1958
              name: 'Port [{#NODE}:{#SLOT}:{#CARD_PORT}]: Hardware type'
              type: DEPENDENT
              key: 'hpe.primera.port.hw.type["{#NODE}:{#SLOT}:{#CARD_PORT}"]'
              delay: '0'
              history: 7d
              description: |
                Hardware type:
                
                FC (1) - Fibre channel HBA;
                ETH (2) - Ethernet NIC;
                iSCSI (3) - iSCSI HBA;
                CNA (4) - Converged network adapter;
                SAS (5) - SAS HBA;
                COMBO (6) - Combo card;
                NVME (7) - NVMe drive;
                UNKNOWN (99) - Unknown hardware type.
              valuemap:
                name: 'Primera: hardwareType enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.portPos.node == "{#NODE}" && @.portPos.slot == "{#SLOT}" && @.portPos.cardPort == "{#CARD_PORT}")].hardwareType.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: hpe.primera.ports
              tags:
                -
                  tag: component
                  value: port
                -
                  tag: label
                  value: '{#LABEL}'
                -
                  tag: port
                  value: '{#NODE}:{#SLOT}:{#CARD_PORT}'
            -
              uuid: 55119ce474024203ac039f4aa797dd4c
              name: 'Port [{#NODE}:{#SLOT}:{#CARD_PORT}]: Link State'
              type: DEPENDENT
              key: 'hpe.primera.port.link.state["{#NODE}:{#SLOT}:{#CARD_PORT}"]'
              delay: '0'
              history: 7d
              description: |
                Port link state:
                
                CONFIG_WAIT (1) - Configuration wait;
                ALPA_WAIT (2) - ALPA wait;
                LOGIN_WAIT (3) - Login wait;
                READY (4) - Link is ready;
                LOSS_SYNC (5) - Link is loss sync;
                ERROR_STATE (6) - In error state;
                XXX (7) - xxx;
                NONPARTICIPATE (8) - Link did not participate;
                COREDUMP (9) - Taking coredump;
                OFFLINE (10) - Link is offline;
                FWDEAD (11) - Firmware is dead;
                IDLE_FOR_RESET (12) - Link is idle for reset;
                DHCP_IN_PROGRESS (13) - DHCP is in progress;
                PENDING_RESET (14) - Link reset is pending;
                NEW (15) - Link in new. This value is applicable for only virtual ports;
                DISABLED (16) - Link in disabled. This value is applicable for only virtual ports;
                DOWN (17) - Link in down. This value is applicable for only virtual ports;
                FAILED (18) - Link in failed. This value is applicable for only virtual ports;
                PURGING (19) - Link in purging. This value is applicable for only virtual ports.
              valuemap:
                name: 'Primera: portLinkState enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.portPos.node == "{#NODE}" && @.portPos.slot == "{#SLOT}" && @.portPos.cardPort == "{#CARD_PORT}")].linkState.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: hpe.primera.ports
              tags:
                -
                  tag: component
                  value: port
                -
                  tag: label
                  value: '{#LABEL}'
                -
                  tag: port
                  value: '{#NODE}:{#SLOT}:{#CARD_PORT}'
              trigger_prototypes:
                -
                  uuid: c7ee19ea175d4c63a9ae67e0ab59253b
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.port.link.state["{#NODE}:{#SLOT}:{#CARD_PORT}"])<>4'
                  name: 'Port [{#NODE}:{#SLOT}:{#CARD_PORT}]: Link state is {ITEM.VALUE1}'
                  priority: HIGH
                  description: 'Port [{#NODE}:{#SLOT}:{#CARD_PORT}] not in ready state.'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: capacity
            -
              uuid: c049e53b25bb4cb58cabbff1d91b3e88
              name: 'Port [{#NODE}:{#SLOT}:{#CARD_PORT}]: Type'
              type: DEPENDENT
              key: 'hpe.primera.port.type["{#NODE}:{#SLOT}:{#CARD_PORT}"]'
              delay: '0'
              history: 7d
              description: |
                Port connection type:
                
                HOST (1) - FC port connected to hosts or fabric;
                DISK (2) - FC port connected to disks;
                FREE (3) - Port is not connected to hosts or disks;
                IPORT (4) - Port is in iport mode;
                RCFC (5) - FC port used for Remote Copy;
                PEER (6) - FC port used for data migration;
                RCIP (7) - IP (Ethernet) port used for Remote Copy;
                ISCSI (8) - iSCSI (Ethernet) port connected to hosts;
                CNA (9) - CNA port, which can be FCoE or iSCSI;
                FS (10) - Ethernet File Persona ports.
              valuemap:
                name: 'Primera: portConnType enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.portPos.node == "{#NODE}" && @.portPos.slot == "{#SLOT}" && @.portPos.cardPort == "{#CARD_PORT}")].type.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: hpe.primera.ports
              tags:
                -
                  tag: component
                  value: port
                -
                  tag: label
                  value: '{#LABEL}'
                -
                  tag: port
                  value: '{#NODE}:{#SLOT}:{#CARD_PORT}'
          master_item:
            key: hpe.primera.ports
          lld_macro_paths:
            -
              lld_macro: '{#CARD_PORT}'
              path: $.portPos.cardPort
            -
              lld_macro: '{#LABEL}'
              path: $.label
            -
              lld_macro: '{#NODE}'
              path: $.portPos.node
            -
              lld_macro: '{#SLOT}'
              path: $.portPos.slot
            -
              lld_macro: '{#TYPE}'
              path: $.type
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        -
          uuid: b47a6afafca6486ea4ffb12dd3322bab
          name: 'Tasks Discovery'
          type: DEPENDENT
          key: hpe.primera.tasks.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#NAME}'
                value: '{$HPE.PRIMERA.LLD.FILTER.TASK.NAME.MATCHES}'
                formulaid: A
              -
                macro: '{#NAME}'
                value: '{$HPE.PRIMERA.LLD.FILTER.TASK.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'List of task resources.'
          item_prototypes:
            -
              uuid: cbcdf169dcf646cb959206bbb6cf3642
              name: 'Task [{#NAME}]: Finish Time'
              type: DEPENDENT
              key: 'hpe.primera.task.finish.time["{#NAME}"]'
              delay: '0'
              history: 7d
              units: unixtime
              description: 'Task finish time.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].finishTime.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
                -
                  type: NOT_MATCHES_REGEX
                  parameters:
                    - ^-$
                  error_handler: DISCARD_VALUE
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      raw_date = value.split(' ');
                      
                      return Date.parse(raw_date[0] + 'T' + raw_date[1] + raw_date[2] + ':00')/1000;
              master_item:
                key: hpe.primera.tasks
              tags:
                -
                  tag: component
                  value: task
                -
                  tag: task
                  value: '{#NAME}'
            -
              uuid: 66140b134d954319a96eb17750da6b7c
              name: 'Task [{#NAME}]: Start Time'
              type: DEPENDENT
              key: 'hpe.primera.task.start.time["{#NAME}"]'
              delay: '0'
              history: 7d
              units: unixtime
              description: 'Task start time.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].startTime.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      raw_date = value.split(' ');
                      
                      return Date.parse(raw_date[0] + 'T' + raw_date[1] + raw_date[2] + ':00')/1000;
              master_item:
                key: hpe.primera.tasks
              tags:
                -
                  tag: component
                  value: task
                -
                  tag: task
                  value: '{#NAME}'
            -
              uuid: e01b3c84a6594e419c358c7ea297159b
              name: 'Task [{#NAME}]: Status'
              type: DEPENDENT
              key: 'hpe.primera.task.status["{#NAME}"]'
              delay: '0'
              history: 7d
              description: |
                Task status:
                
                DONE (1) - Task is finished;
                ACTIVE (2) - Task is in progress;
                CANCELLED (3) - Task is canceled;
                FAILED (4) - Task failed.
              valuemap:
                name: 'Primera: taskStatus enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].status.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: hpe.primera.tasks
              tags:
                -
                  tag: component
                  value: task
                -
                  tag: task
                  value: '{#NAME}'
              trigger_prototypes:
                -
                  uuid: 63340c376d86492198e00d7ae10f063c
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.task.status["{#NAME}"])=3'
                  name: 'Task [{#NAME}]: Cancelled'
                  priority: INFO
                  description: 'Task [{#NAME}] is cancelled.'
                  tags:
                    -
                      tag: scope
                      value: notice
                -
                  uuid: af326c0f259144d28ebeb60e19bae903
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.task.status["{#NAME}"])=4'
                  name: 'Task [{#NAME}]: Failed'
                  priority: AVERAGE
                  description: 'Task [{#NAME}] is failed.'
                  tags:
                    -
                      tag: scope
                      value: notice
          master_item:
            key: hpe.primera.tasks
          lld_macro_paths:
            -
              lld_macro: '{#NAME}'
              path: $.name
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        -
          uuid: eb73fcc415c54ac18840d2655f048f6c
          name: 'Volumes Discovery'
          type: DEPENDENT
          key: hpe.primera.volumes.discovery
          delay: '0'
          description: 'List of storage volume resources.'
          item_prototypes:
            -
              uuid: 35457814e61a432c95820d38607b402f
              name: 'Volume [{#NAME}]: Additional State'
              type: DEPENDENT
              key: 'hpe.primera.volume.additional.states["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                Detailed state of the VV:
                
                LDS_NOT_STARTED (1) - LDs not started.
                NOT_STARTED (2) - VV not started.
                NEEDS_CHECK (3) - Check for consistency.
                NEEDS_MAINT_CHECK (4) - Maintenance check is required.
                INTERNAL_CONSISTENCY_ERROR (5) - Internal consistency error.
                SNAPDATA_INVALID (6) - Invalid snapshot data.
                PRESERVED (7) - Unavailable LD sets due to missing chunklets. Preserved remaining VV data.
                STALE (8) - Parts of the VV contain old data because of a copy-on-write operation.
                COPY_FAILED (9) - A promote or copy operation to this volume failed.
                DEGRADED_AVAIL (10) - Degraded due to availability.
                DEGRADED_PERF (11) - Degraded due to performance.
                PROMOTING (12) - Volume is the current target of a promote operation.
                COPY_TARGET (13) - Volume is the current target of a physical copy operation.
                RESYNC_TARGET (14) - Volume is the current target of a resynchronized copy operation.
                TUNING (15) - Volume tuning is in progress.
                CLOSING (16) - Volume is closing.
                REMOVING (17) - Removing the volume.
                REMOVING_RETRY (18) - Retrying a volume removal operation.
                CREATING (19) - Creating a volume.
                COPY_SOURCE (20) - Copy source.
                IMPORTING (21) - Importing a volume.
                CONVERTING (22) - Converting a volume.
                INVALID (23) - Invalid.
                EXCLUSIVE (24) - Local storage system has exclusive access to the volume.
                CONSISTENT (25) - Volume is being imported consistently along with other volumes in the VV set.
                STANDBY (26) - Volume in Standby mode.
                SD_META_INCONSISTENT (27) - SD Meta Inconsistent.
                SD_NEEDS_FIX (28) - SD needs fix.
                SD_META_FIXING (29) - SD meta fix.
                UNKNOWN (999) - Unknown state.
                NOT_SUPPORTED_BY_WSAPI (1000) - State not supported by WSAPI.
              valuemap:
                name: 'Primera: Volume detailed state enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].additionalStates.first()'
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return JSON.stringify(JSON.parse(value));'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: bb78eda6a941407581f78cf29ef2b647
              name: 'Volume [{#NAME}]: Administrative Free space'
              type: DEPENDENT
              key: 'hpe.primera.volume.admin.free.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Administrative space. Free space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].adminSpace.freeMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: e4f9f8f5c1cd494896eba973b072fc57
              name: 'Volume [{#NAME}]: Administrative Raw reserved space'
              type: DEPENDENT
              key: 'hpe.primera.volume.admin.raw.reserved.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Administrative space. Raw reserved space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].adminSpace.rawReservedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: e5a93a042a3b41bab4cf59dc71ec66bf
              name: 'Volume [{#NAME}]: Administrative reserved space'
              type: DEPENDENT
              key: 'hpe.primera.volume.admin.reserved.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Administrative space. Reserved space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].adminSpace.reservedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 67e182afc0124cf5913b0499317a7966
              name: 'Volume [{#NAME}]: Administrative used space'
              type: DEPENDENT
              key: 'hpe.primera.volume.admin.used.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Administrative space. Used space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].adminSpace.usedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 3b88e49e88484fe4a77e2a96f6d48322
              name: 'Volume [{#NAME}]: Overprovisioning ratio'
              type: DEPENDENT
              key: 'hpe.primera.volume.capacity.efficiency..overprovisioning["{#NAME}"]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Capacity efficiency. Overprovisioning ratio.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].capacityEfficiency.overProvisioning.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 40db4c8f6d85414e843c97770225f93d
              name: 'Volume [{#NAME}]: Compaction ratio'
              type: DEPENDENT
              key: 'hpe.primera.volume.capacity.efficiency.compaction["{#NAME}"]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Capacity efficiency. The compaction ratio indicates the overall amount of storage space saved with thin technology.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].capacityEfficiency.compaction.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: ab2a583c4b4049a6ac8b7bbc02bda8f5
              name: 'Volume [{#NAME}]: Storage space saved using compression'
              type: DEPENDENT
              key: 'hpe.primera.volume.capacity.efficiency.compression["{#NAME}"]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Indicates the amount of storage space saved using compression.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].capacityEfficiency.compression.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: f584938e60f94c46b4ed28cc614c797d
              name: 'Volume [{#NAME}]: Storage space saved using deduplication and compression'
              type: DEPENDENT
              key: 'hpe.primera.volume.capacity.efficiency.data.reduction["{#NAME}"]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Capacity efficiency. Indicates the amount of storage space saved using deduplication and compression together.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].capacityEfficiency.dataReduction.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 1c4d78b2dcd64efbbf710ef602a94573
              name: 'Volume [{#NAME}]: Storage space saved using deduplication'
              type: DEPENDENT
              key: 'hpe.primera.volume.capacity.efficiency.deduplication["{#NAME}"]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Indicates the amount of storage space saved using deduplication.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].capacityEfficiency.deduplication.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: beb17415bd07492d83944da714c492e7
              name: 'Volume [{#NAME}]: Compression State'
              type: DEPENDENT
              key: 'hpe.primera.volume.compression.state["{#NAME}"]'
              delay: '0'
              history: 7d
              description: |
                Volume compression state:
                
                YES (1) - Compression is enabled on the volume;
                NO (2) - Compression is disabled on the volume;
                OFF (3) - Compression is turned off;
                NA (4) - Compression is not available on the volume.
              valuemap:
                name: 'Primera: Volume compressionState enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].compressionState.first()'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 3962d07122a0460fa36c1b151a87717b
              name: 'Volume [{#NAME}]: Deduplication State'
              type: DEPENDENT
              key: 'hpe.primera.volume.deduplication.state["{#NAME}"]'
              delay: '0'
              history: 7d
              description: |
                Volume deduplication state:
                
                YES (1) - Enables deduplication on the volume;
                NO (2) - Disables deduplication on the volume;
                NA (3) - Deduplication is not available;
                OFF (4) - Deduplication is turned off.
              valuemap:
                name: 'Primera: Volume deduplicationState enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].deduplicationState.first()'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 83222faf4e3e414789e028e0b17350c6
              name: 'Volume [{#NAME}]: Degraded State'
              type: DEPENDENT
              key: 'hpe.primera.volume.degraded.state["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                Volume detailed state:
                
                LDS_NOT_STARTED (1) - LDs not started.
                NOT_STARTED (2) - VV not started.
                NEEDS_CHECK (3) - Check for consistency.
                NEEDS_MAINT_CHECK (4) - Maintenance check is required.
                INTERNAL_CONSISTENCY_ERROR (5) - Internal consistency error.
                SNAPDATA_INVALID (6) - Invalid snapshot data.
                PRESERVED (7) - Unavailable LD sets due to missing chunklets. Preserved remaining VV data.
                STALE (8) - Parts of the VV contain old data because of a copy-on-write operation.
                COPY_FAILED (9) - A promote or copy operation to this volume failed.
                DEGRADED_AVAIL (10) - Degraded due to availability.
                DEGRADED_PERF (11) - Degraded due to performance.
                PROMOTING (12) - Volume is the current target of a promote operation.
                COPY_TARGET (13) - Volume is the current target of a physical copy operation.
                RESYNC_TARGET (14) - Volume is the current target of a resynchronized copy operation.
                TUNING (15) - Volume tuning is in progress.
                CLOSING (16) - Volume is closing.
                REMOVING (17) - Removing the volume.
                REMOVING_RETRY (18) - Retrying a volume removal operation.
                CREATING (19) - Creating a volume.
                COPY_SOURCE (20) - Copy source.
                IMPORTING (21) - Importing a volume.
                CONVERTING (22) - Converting a volume.
                INVALID (23) - Invalid.
                EXCLUSIVE (24) - Local storage system has exclusive access to the volume.
                CONSISTENT (25) - Volume is being imported consistently along with other volumes in the VV set.
                STANDBY (26) - Volume in Standby mode.
                SD_META_INCONSISTENT (27) - SD Meta Inconsistent.
                SD_NEEDS_FIX (28) - SD needs fix.
                SD_META_FIXING (29) - SD meta fix.
                UNKNOWN (999) - Unknown state.
                NOT_SUPPORTED_BY_WSAPI (1000) - State not supported by WSAPI.
              valuemap:
                name: 'Primera: Volume detailed state enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].degradedStates.first()'
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return JSON.stringify(JSON.parse(value));'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 462e4b491dd94c78b299178af6d34ca0
              name: 'Volume [{#NAME}]: Failed State'
              type: DEPENDENT
              key: 'hpe.primera.volume.failed.state["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                Volume detailed state:
                
                LDS_NOT_STARTED (1) - LDs not started.
                NOT_STARTED (2) - VV not started.
                NEEDS_CHECK (3) - Check for consistency.
                NEEDS_MAINT_CHECK (4) - Maintenance check is required.
                INTERNAL_CONSISTENCY_ERROR (5) - Internal consistency error.
                SNAPDATA_INVALID (6) - Invalid snapshot data.
                PRESERVED (7) - Unavailable LD sets due to missing chunklets. Preserved remaining VV data.
                STALE (8) - Parts of the VV contain old data because of a copy-on-write operation.
                COPY_FAILED (9) - A promote or copy operation to this volume failed.
                DEGRADED_AVAIL (10) - Degraded due to availability.
                DEGRADED_PERF (11) - Degraded due to performance.
                PROMOTING (12) - Volume is the current target of a promote operation.
                COPY_TARGET (13) - Volume is the current target of a physical copy operation.
                RESYNC_TARGET (14) - Volume is the current target of a resynchronized copy operation.
                TUNING (15) - Volume tuning is in progress.
                CLOSING (16) - Volume is closing.
                REMOVING (17) - Removing the volume.
                REMOVING_RETRY (18) - Retrying a volume removal operation.
                CREATING (19) - Creating a volume.
                COPY_SOURCE (20) - Copy source.
                IMPORTING (21) - Importing a volume.
                CONVERTING (22) - Converting a volume.
                INVALID (23) - Invalid.
                EXCLUSIVE (24) - Local storage system has exclusive access to the volume.
                CONSISTENT (25) - Volume is being imported consistently along with other volumes in the VV set.
                STANDBY (26) - Volume in Standby mode.
                SD_META_INCONSISTENT (27) - SD Meta Inconsistent.
                SD_NEEDS_FIX (28) - SD needs fix.
                SD_META_FIXING (29) - SD meta fix.
                UNKNOWN (999) - Unknown state.
                NOT_SUPPORTED_BY_WSAPI (1000) - State not supported by WSAPI.
              valuemap:
                name: 'Primera: Volume detailed state enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].failedStates.first()'
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return JSON.stringify(JSON.parse(value));'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 582544eb48d04a35ab03a9d01901feb9
              name: 'Volume [{#NAME}]: Remote Copy Status'
              type: DEPENDENT
              key: 'hpe.primera.volume.rcopy.status["{#NAME}"]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                Remote Copy status of the volume:
                
                NONE (1) - Volume is not associated with Remote Copy;
                PRIMARY (2) - Volume is the primary copy;
                SECONDARY (3) - Volume is the secondary copy;
                SNAP (4) - Volume is the Remote Copy snapshot;
                SYNC (5) - Volume is a Remote Copy snapshot being used for synchronization;
                DELETE (6) - Volume is a Remote Copy snapshot that is marked for deletion;
                UNKNOWN (99) - Remote Copy status is unknown for this volume.
              valuemap:
                name: 'Primera: rcopyStatus enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].rcopyStatus.first()'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: af15ec5befd146afbfb2b9cc017d03be
              name: 'Volume [{#NAME}]: Total Size'
              type: DEPENDENT
              key: 'hpe.primera.volume.size["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Virtual size of volume.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].sizeMiB.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 5d4659c72ed3492da143ad9c37e71360
              name: 'Volume [{#NAME}]: Snapshot Free space'
              type: DEPENDENT
              key: 'hpe.primera.volume.snapshot.free.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot space. Free space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].snapshotSpace.freeMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: a2c22eed1c004bcc9292b945b5038858
              name: 'Volume [{#NAME}]: Snapshot Raw reserved space'
              type: DEPENDENT
              key: 'hpe.primera.volume.snapshot.raw.reserved.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot space. Raw reserved space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].snapshotSpace.rawReservedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: a37265c4598f4179bdcfd816769a1d9b
              name: 'Volume [{#NAME}]: Snapshot reserved space'
              type: DEPENDENT
              key: 'hpe.primera.volume.snapshot.reserved.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot space. Reserved space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].snapshotSpace.reservedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: a278f5ec08c747b085ec53a36357539c
              name: 'Volume [{#NAME}]: Snapshot used space'
              type: DEPENDENT
              key: 'hpe.primera.volume.snapshot.used.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Snapshot space. Used space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].snapshotSpace.usedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 4d4e34fdbac84cada109cbfe9b69812c
              name: 'Volume [{#NAME}]: State'
              type: DEPENDENT
              key: 'hpe.primera.volume.state["{#NAME}"]'
              delay: '0'
              history: 7d
              description: |
                State of the volume:
                
                NORMAL (1) - Normal operation;
                DEGRADED (2) - Degraded state;
                FAILED (3) - Abnormal operation;
                UNKNOWN (99) - Unknown state.
              valuemap:
                name: 'Primera: State enum'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].state.first()'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
              trigger_prototypes:
                -
                  uuid: c91920ca3ceb457cb9e2db0bb70d7fe0
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.volume.state["{#NAME}"])=2'
                  name: 'Volume [{#NAME}]: Degraded'
                  priority: AVERAGE
                  description: 'Volume [{#NAME}] in degraded state.'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: capacity
                -
                  uuid: 394b5bd072ac41acb0702601c5d5f049
                  expression: 'last(/HPE Primera by HTTP/hpe.primera.volume.state["{#NAME}"])=3'
                  name: 'Volume [{#NAME}]: Failed'
                  priority: HIGH
                  description: 'Volume [{#NAME}] in failed state.'
                  tags:
                    -
                      tag: scope
                      value: availability
                    -
                      tag: scope
                      value: capacity
            -
              uuid: 64825e4092c6450a8ea7fb7bce2d85ce
              name: 'Volume [{#NAME}]: Total Reserved Size'
              type: DEPENDENT
              key: 'hpe.primera.volume.total.reserved["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Total Reserved space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].totalReservedMiB.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 6000ab524b394e65afe111b65f7b6fd8
              name: 'Volume [{#NAME}]: Total Used Size'
              type: DEPENDENT
              key: 'hpe.primera.volume.total.used["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'Total used space. Sum of used UserSpace and used Snapshot space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].totalUsedMiB.first()'
                  error_handler: DISCARD_VALUE
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 43c278563b174005ac5302ee48e0cd30
              name: 'Volume [{#NAME}]: User Free space'
              type: DEPENDENT
              key: 'hpe.primera.volume.user.free.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'User space. Free space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].userSpace.freeMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 97aaefe8dffd4d2eb83f908ac8ad775b
              name: 'Volume [{#NAME}]: User Raw reserved space'
              type: DEPENDENT
              key: 'hpe.primera.volume.user.raw.reserved.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'User space. Raw reserved space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].userSpace.rawReservedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 135ad5457781492db1cec36787151a71
              name: 'Volume [{#NAME}]: User reserved space'
              type: DEPENDENT
              key: 'hpe.primera.volume.user.reserved.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'User space. Reserved space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].userSpace.reservedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
            -
              uuid: 3adf03216c4f442693fccbb991c0de3d
              name: 'Volume [{#NAME}]: User used space'
              type: DEPENDENT
              key: 'hpe.primera.volume.user.used.space["{#NAME}"]'
              delay: '0'
              history: 7d
              units: B
              description: 'User space. Used space.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.name == "{#NAME}")].userSpace.usedMiB.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              master_item:
                key: hpe.primera.volumes
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: component
                  value: volume
                -
                  tag: volume
                  value: '{#NAME}'
          graph_prototypes:
            -
              uuid: 8c7139d2b7d94773ad6ef813c7fa59c9
              name: 'Volume [{#NAME}]: Administrative space'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.admin.free.space["{#NAME}"]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.admin.raw.reserved.space["{#NAME}"]'
                -
                  sortorder: '2'
                  color: F63100
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.admin.reserved.space["{#NAME}"]'
                -
                  sortorder: '3'
                  color: A54F10
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.admin.used.space["{#NAME}"]'
            -
              uuid: c74b88d4e61d4264b804965854eb1da1
              name: 'Volume [{#NAME}]: Capacity Efficiency (ratio)'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.capacity.efficiency.compaction["{#NAME}"]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.capacity.efficiency..overprovisioning["{#NAME}"]'
            -
              uuid: d2a75ebb20c94eb4ab5e6a9b13d1d439
              name: 'Volume [{#NAME}]: Capacity Efficiency (space)'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.capacity.efficiency.compression["{#NAME}"]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.capacity.efficiency.deduplication["{#NAME}"]'
                -
                  sortorder: '2'
                  color: F63100
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.capacity.efficiency.data.reduction["{#NAME}"]'
            -
              uuid: 7214605009354fd382368ec8699d5474
              name: 'Volume [{#NAME}]: Snapshot space'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.snapshot.free.space["{#NAME}"]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.snapshot.raw.reserved.space["{#NAME}"]'
                -
                  sortorder: '2'
                  color: F63100
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.snapshot.reserved.space["{#NAME}"]'
                -
                  sortorder: '3'
                  color: A54F10
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.snapshot.used.space["{#NAME}"]'
            -
              uuid: 0ad9f609419340168bf7f49de98e0135
              name: 'Volume [{#NAME}]: User space'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.user.free.space["{#NAME}"]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.user.raw.reserved.space["{#NAME}"]'
                -
                  sortorder: '2'
                  color: F63100
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.user.reserved.space["{#NAME}"]'
                -
                  sortorder: '3'
                  color: A54F10
                  item:
                    host: 'HPE Primera by HTTP'
                    key: 'hpe.primera.volume.user.used.space["{#NAME}"]'
          master_item:
            key: hpe.primera.volumes
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#NAME}'
              path: $.name
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
      tags:
        -
          tag: class
          value: storage
        -
          tag: target
          value: hpe
        -
          tag: target
          value: primera
      macros:
        -
          macro: '{$HPE.PRIMERA.DATA.TIMEOUT}'
          value: 3s
          description: 'Response timeout for WSAPI.'
        -
          macro: '{$HPE.PRIMERA.LLD.FILTER.TASK.NAME.MATCHES}'
          value: '.*'
          description: 'Filter of discoverable tasks by name.'
        -
          macro: '{$HPE.PRIMERA.LLD.FILTER.TASK.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Filter to exclude discovered tasks by name.'
        -
          macro: '{$HPE.PRIMERA.PASSWORD}'
          type: SECRET_TEXT
          description: 'Specify password for WSAPI.'
        -
          macro: '{$HPE.PRIMERA.USERNAME}'
          value: zabbix
          description: 'Specify user name for WSAPI.'
      valuemaps:
        -
          uuid: fd9a3483b02f45c6836b9a126b669402
          name: 'Primera: diskState enum'
          mappings:
            -
              value: '1'
              newvalue: Normal
            -
              value: '2'
              newvalue: Degraded
            -
              value: '3'
              newvalue: New
            -
              value: '4'
              newvalue: Failed
            -
              value: '99'
              newvalue: Unknown
        -
          uuid: 7513c4c923884ed4b8e35ee9cdf4f627
          name: 'Primera: hardwareType enum'
          mappings:
            -
              value: '1'
              newvalue: FC
            -
              value: '2'
              newvalue: Eth
            -
              value: '3'
              newvalue: iSCSI
            -
              value: '4'
              newvalue: CNA
            -
              value: '5'
              newvalue: SAS
            -
              value: '6'
              newvalue: Combo
            -
              value: '7'
              newvalue: NVMe
            -
              value: '8'
              newvalue: Unknown
        -
          uuid: 5d243add5b534ebfac8ef95d55c4c8c9
          name: 'Primera: portConnType enum'
          mappings:
            -
              value: '1'
              newvalue: Host
            -
              value: '2'
              newvalue: Disk
            -
              value: '3'
              newvalue: Free
            -
              value: '4'
              newvalue: Iport
            -
              value: '5'
              newvalue: RCFC
            -
              value: '6'
              newvalue: Peer
            -
              value: '7'
              newvalue: RCIP
            -
              value: '8'
              newvalue: ISCSI
            -
              value: '9'
              newvalue: CNA
            -
              value: '10'
              newvalue: FS
        -
          uuid: 5762248dd10143a3945c989f0fb73b47
          name: 'Primera: portFailOverState enum'
          mappings:
            -
              value: '1'
              newvalue: None
            -
              value: '2'
              newvalue: 'Failover pending'
            -
              value: '3'
              newvalue: 'Failed over'
            -
              value: '4'
              newvalue: Active
            -
              value: '5'
              newvalue: 'Active down'
            -
              value: '6'
              newvalue: 'Active failed'
            -
              value: '7'
              newvalue: Failback_pending
        -
          uuid: 5a6cdc765c254f17b136c4267fc71349
          name: 'Primera: portLinkState enum'
          mappings:
            -
              value: '1'
              newvalue: 'Config wait'
            -
              value: '2'
              newvalue: 'ALPA wait'
            -
              value: '3'
              newvalue: 'Login wait'
            -
              value: '4'
              newvalue: 'Link is ready'
            -
              value: '5'
              newvalue: 'Link is loss sync'
            -
              value: '6'
              newvalue: 'In error state'
            -
              value: '7'
              newvalue: xxx
            -
              value: '8'
              newvalue: 'Non participate'
            -
              value: '9'
              newvalue: 'Core dump'
            -
              value: '10'
              newvalue: Offline
            -
              value: '11'
              newvalue: 'FW dead'
            -
              value: '12'
              newvalue: 'Idle for reset'
            -
              value: '13'
              newvalue: 'DHCP in progress'
            -
              value: '14'
              newvalue: 'Pending reset'
            -
              value: '15'
              newvalue: New
            -
              value: '16'
              newvalue: Disabled
            -
              value: '17'
              newvalue: Down
            -
              value: '18'
              newvalue: Failed
            -
              value: '19'
              newvalue: Purging
        -
          uuid: eb36574d642d4f9ea51688b4ff971c91
          name: 'Primera: rcopyStatus enum'
          mappings:
            -
              value: '1'
              newvalue: None
            -
              value: '2'
              newvalue: Primary
            -
              value: '3'
              newvalue: Secondary
            -
              value: '4'
              newvalue: Snap
            -
              value: '5'
              newvalue: Sync
            -
              value: '6'
              newvalue: Delete
            -
              value: '99'
              newvalue: Unknown
        -
          uuid: 86e4337cbc86423fb9f605a9fb3b25b1
          name: 'Primera: State enum'
          mappings:
            -
              value: '1'
              newvalue: Normal
            -
              value: '2'
              newvalue: Degraded
            -
              value: '3'
              newvalue: Failed
            -
              value: '99'
              newvalue: Unknown
        -
          uuid: 5cfd4442b6244399b7aa8b57e9816a4e
          name: 'Primera: taskStatus enum'
          mappings:
            -
              value: '1'
              newvalue: Done
            -
              value: '2'
              newvalue: Active
            -
              value: '3'
              newvalue: Cancelled
            -
              value: '4'
              newvalue: Failed
        -
          uuid: f529111642364bb3a23637adc554e592
          name: 'Primera: Volume compressionState enum'
          mappings:
            -
              value: '1'
              newvalue: 'Yes'
            -
              value: '2'
              newvalue: 'No'
            -
              value: '3'
              newvalue: 'Off'
            -
              value: '4'
              newvalue: NA
        -
          uuid: 716912c7b7d94f8e97fbf911edc9578e
          name: 'Primera: Volume deduplicationState enum'
          mappings:
            -
              value: '1'
              newvalue: 'Yes'
            -
              value: '2'
              newvalue: 'No'
            -
              value: '3'
              newvalue: NA
            -
              value: '4'
              newvalue: 'Off'
        -
          uuid: 6a2355e32bf54483b252f1aaf170aa45
          name: 'Primera: Volume detailed state enum'
          mappings:
            -
              value: '1'
              newvalue: 'LDS not started'
            -
              value: '2'
              newvalue: 'VV not started'
            -
              value: '3'
              newvalue: 'Needs check'
            -
              value: '4'
              newvalue: 'Needs maint check'
            -
              value: '5'
              newvalue: 'Internal consistency error'
            -
              value: '6'
              newvalue: 'Snapdata invalid'
            -
              value: '7'
              newvalue: Preserved
            -
              value: '8'
              newvalue: Stale
            -
              value: '9'
              newvalue: 'Copy failed'
            -
              value: '10'
              newvalue: 'Degraded avail'
            -
              value: '11'
              newvalue: 'Degraded perf'
            -
              value: '12'
              newvalue: Promoting
            -
              value: '13'
              newvalue: 'Copy target'
            -
              value: '14'
              newvalue: 'Resync target'
            -
              value: '15'
              newvalue: Tuning
            -
              value: '16'
              newvalue: Closing
            -
              value: '17'
              newvalue: Removing
            -
              value: '18'
              newvalue: 'Removing retry'
            -
              value: '19'
              newvalue: Creating
            -
              value: '20'
              newvalue: 'Copy source'
            -
              value: '21'
              newvalue: Importing
            -
              value: '22'
              newvalue: Converting
            -
              value: '23'
              newvalue: Invalid
            -
              value: '24'
              newvalue: Exclusive
            -
              value: '25'
              newvalue: Consistent
            -
              value: '26'
              newvalue: Standby
            -
              value: '27'
              newvalue: 'SD Meta inconsistent'
            -
              value: '28'
              newvalue: 'SD needs fix'
            -
              value: '29'
              newvalue: 'SD meta fix'
            -
              value: '999'
              newvalue: 'Unknown state'
            -
              value: '1000'
              newvalue: 'State not supported by WSAPI'
